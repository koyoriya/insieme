# Insieme

**LLMã«ã‚ˆã‚‹ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆå‹å•é¡Œä½œæˆ&å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ **

## æ¦‚è¦

Insiemeã¯Google Gemini AIã‚’æ´»ç”¨ã—ãŸæ•™è‚²æ”¯æ´ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŒ‡å®šã—ãŸãƒˆãƒ”ãƒƒã‚¯ã«åŸºã¥ã„ã¦ã€è‡ªå‹•çš„ã«å­¦ç¿’å•é¡Œã‚’ç”Ÿæˆã—ã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆå½¢å¼ã§æä¾›ã—ã¾ã™ã€‚

## ä¸»è¦æ©Ÿèƒ½

### ğŸ¯ ã‚³ã‚¢æ©Ÿèƒ½
- **ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆç”Ÿæˆ**: LLMã«ã‚ˆã‚‹è‡ªå‹•å•é¡Œä½œæˆï¼ˆè¤‡æ•°å•é¡Œã‚’ã‚»ãƒƒãƒˆåŒ–ï¼‰
- **å•é¡Œå½¢å¼**: é¸æŠå•é¡Œãƒ»è¨˜è¿°å•é¡Œãƒ»è«–è¿°å•é¡Œã®è‡ªå‹•åˆ¤å®šã¨çµ„ã¿åˆã‚ã›
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼**: Firebase Authenticationï¼ˆGoogle SSOå¯¾å¿œï¼‰
- **å›ç­”ãƒ»æ¡ç‚¹**: ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆå˜ä½ã§ã®ä¸€æ‹¬å›ç­”æå‡ºã¨è‡ªå‹•æ¡ç‚¹
- **å­¦ç¿’å±¥æ­´**: ä½œæˆã—ãŸãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã¨æå‡ºçŠ¶æ³ã®ç®¡ç†

### ğŸ“Š ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆç®¡ç†
- **çŠ¶æ…‹è¿½è·¡**: ä½œæˆä¸­ â†’ æœªå›ç­” â†’ æå‡ºæ¸ˆã¿ â†’ ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®ç®¡ç†
- **ç¸¦åˆ—è¡¨ç¤º**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆä¸€è¦§è¡¨ç¤º
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿**: é›£æ˜“åº¦ãƒ»ãƒˆãƒ”ãƒƒã‚¯ãƒ»ä½œæˆæ—¥æ™‚ãƒ»å•é¡Œæ•°ã®è¡¨ç¤º
- **ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: çŠ¶æ…‹åˆ¥ãƒ»æœŸé–“åˆ¥ã§ã®çµã‚Šè¾¼ã¿

### ğŸ” ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ**: ä½œæˆè€…ã®ã¿ãŒã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- **æ¨¡ç¯„è§£ç­”ä¿è­·**: å›ç­”æå‡ºå¾Œã®ã¿é–²è¦§å¯èƒ½
- **ç·¨é›†åˆ¶é™**: ä½œæˆå¾Œã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆç·¨é›†ã¯ä¸å¯

### ğŸ“± ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: ãƒ¢ãƒã‚¤ãƒ«ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—å¯¾å¿œ
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**: Firestoreã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿åŒæœŸ
- **ç›´æ„Ÿçš„æ“ä½œ**: ä½¿ã„ã‚„ã™ã„ãƒ•ã‚©ãƒ¼ãƒ ã¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| è¦ç´  | æŠ€è¡“ | ç”¨é€” | è©³ç´° |
|------|------|------|------|
| **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰** | Next.js 15 + TypeScript | React Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | é™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€App Router |
| **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°** | Tailwind CSS | ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–UI | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSS |
| **ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°** | Firebase Hosting | é™çš„ã‚µã‚¤ãƒˆé…ä¿¡ | CDNã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³å¯¾å¿œ |
| **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰** | Firebase Functions (Node.js 18) | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹API | HTTPé–¢æ•°ã€CORSå¯¾å¿œ |
| **AI/LLM** | **Google Gemini 2.0 Flash** | å•é¡Œç”Ÿæˆ | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹** | Cloud Firestore | NoSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ« |
| **èªè¨¼** | Firebase Authentication | ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ | Google OAuthã€JWT |
| **CI/CD** | GitHub Actions | è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ | ç’°å¢ƒåˆ†é›¢ã€ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ– |
| **é–‹ç™ºãƒ„ãƒ¼ãƒ«** | ESLint + TypeScript | ã‚³ãƒ¼ãƒ‰å“è³ª | å‹å®‰å…¨æ€§ã€ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚° |

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# é–‹ç™ºç’°å¢ƒã®è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make setup-dev

# ã¾ãŸã¯æ‰‹å‹•ã§å®Ÿè¡Œï¼ˆå®Ÿè¡Œæ¨©é™ãŒå¿…è¦ãªå ´åˆï¼‰
chmod +x scripts/setup-dev.sh
./scripts/setup-dev.sh
```

> **Note**: MakefileãŒè‡ªå‹•çš„ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ãŸã‚ã€é€šå¸¸ã¯`chmod`ã¯ä¸è¦ã§ã™ã€‚

### ğŸ“‹ åˆ©ç”¨å¯èƒ½ãªMakeã‚³ãƒãƒ³ãƒ‰

```bash
make help                 # åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ã‚’è¡¨ç¤º
make setup-dev           # é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make setup-firebase      # Firebaseã®è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make test               # å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
make dev-frontend       # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
make dev-functions      # Firebase Functionsé–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
make clean              # ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
```

## ç’°å¢ƒãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š

### ğŸŒ ç’°å¢ƒæ§‹æˆ

| ç’°å¢ƒ | ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³• | Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ | ç”¨é€” |
|------|-------------|---------------------|------|
| **é–‹ç™º** | ãƒ­ãƒ¼ã‚«ãƒ«æ‰‹å‹• | `insieme-dev-d7459` | é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ç’°å¢ƒ |
| **æœ¬ç•ª** | `main`ãƒ–ãƒ©ãƒ³ãƒè‡ªå‹• | `insieme-463312` | æœ¬ç•ªã‚µãƒ¼ãƒ“ã‚¹ |

### ğŸ› ï¸ äº‹å‰æº–å‚™

ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ï¼š

```bash
# macOS
brew install google-cloud-sdk
npm install -g firebase-tools

# ä»–ã®OS
# Google Cloud SDK: https://cloud.google.com/sdk/docs/install
# Firebase CLI: npm install -g firebase-tools
```

### ğŸ”§ è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰

```bash
# å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯
make validate-env

# Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make setup-firebase PROJECT_ID=your-project-id

# Firebase CI tokenå–å¾—ï¼ˆGitHub Actionsç”¨ï¼‰
make get-firebase-token
```

### ğŸ“ GitHub Secretsè¨­å®š

GitHub ãƒªãƒã‚¸ãƒˆãƒªã® **Settings > Secrets and variables > Actions** ã§ä»¥ä¸‹ã‚’è¨­å®šï¼š

#### å¿…é ˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆæœ¬ç•ªè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ï¼‰
| Secretå | èª¬æ˜ | å–å¾—æ–¹æ³• |
|----------|------|----------|
| `FIREBASE_TOKEN` | Firebase CLIèªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ | `firebase login:ci` |
| `FIREBASE_PROJECT_ID` | æœ¬ç•ªç”¨Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID | `insieme-463312` |
| `GEMINI_API_KEY` | æœ¬ç•ªç”¨ Gemini API ã‚­ãƒ¼ | Google AI Studio |

#### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨
| ç’°å¢ƒå¤‰æ•° | èª¬æ˜ | è¨­å®šå ´æ‰€ |
|----------|------|----------|
| `GEMINI_API_KEY_DEV` | é–‹ç™ºç”¨ Gemini API ã‚­ãƒ¼ | ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒå¤‰æ•° |

#### Firebase CLI ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—

```bash
# Firebase CLI ã«ãƒ­ã‚°ã‚¤ãƒ³
firebase login:ci

# è¡¨ç¤ºã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ FIREBASE_TOKEN ã«è¨­å®š
```

### ğŸ”„ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

#### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼
- **main ãƒ–ãƒ©ãƒ³ãƒ**: æœ¬ç•ªç’°å¢ƒï¼ˆ`insieme-463312`ï¼‰ã¸è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
- **Pull Request**: CI ãƒ†ã‚¹ãƒˆï¼ˆãƒ“ãƒ«ãƒ‰ãƒ»ãƒªãƒ³ãƒˆãƒ»å‹ãƒã‚§ãƒƒã‚¯ï¼‰å®Ÿè¡Œ
- **é–‹ç™ºç’°å¢ƒ**: ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆ`insieme-dev-d7459`ï¼‰

#### ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹æˆ
1. **CIæ®µéš**: 
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ãƒ“ãƒ«ãƒ‰ãƒ»ãƒªãƒ³ãƒˆãƒ»å‹ãƒã‚§ãƒƒã‚¯ãƒ»ãƒ†ã‚¹ãƒˆ
   - Functions: ãƒ“ãƒ«ãƒ‰ãƒ»ãƒªãƒ³ãƒˆãƒ»TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
   - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: Trivyè„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³

2. **CDæ®µéš**:
   - ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆFirebase Functions configï¼‰
   - æœ¬ç•ª/é–‹ç™ºç’°å¢ƒã¸ã®ä¸¦åˆ—ãƒ‡ãƒ—ãƒ­ã‚¤
   - Hosting + Functions åŒæ™‚ãƒ‡ãƒ—ãƒ­ã‚¤

### ğŸš€ æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤

#### GitHub Actions UIä½¿ç”¨
- Actions ã‚¿ãƒ–ã‹ã‚‰ `workflow_dispatch` ã§æ‰‹å‹•å®Ÿè¡Œå¯èƒ½

#### ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰é–‹ç™ºç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤

**é–‹ç™ºãƒ»æ¤œè¨¼ç”¨ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †**:

```bash
# 1. é–‹ç™ºç’°å¢ƒç”¨ Gemini API ã‚­ãƒ¼è¨­å®š
export GEMINI_API_KEY_DEV="your_dev_api_key"

# 2. é–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆ‡ã‚Šæ›¿ãˆ
firebase use dev  # insieme-dev-d7459

# 3. Functions ç’°å¢ƒå¤‰æ•°è¨­å®š
firebase functions:config:set gemini.api_key="$GEMINI_API_KEY_DEV"

# 4. ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
cd frontend && npm run build
cd ../functions && npm run build

# 5. ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
firebase deploy

# å€‹åˆ¥ãƒ‡ãƒ—ãƒ­ã‚¤ã‚ªãƒ—ã‚·ãƒ§ãƒ³
firebase deploy --only hosting           # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿
firebase deploy --only functions         # Functions ã®ã¿
firebase deploy --only firestore:rules   # Firestore ãƒ«ãƒ¼ãƒ«ã®ã¿
```

#### æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ‰‹å‹•å®Ÿè¡Œæ™‚ï¼‰

```bash
# æœ¬ç•ªç’°å¢ƒï¼ˆé€šå¸¸ã¯ main ãƒ–ãƒ©ãƒ³ãƒã§è‡ªå‹•å®Ÿè¡Œï¼‰
firebase use production  # insieme-463312
firebase deploy
```

## é–‹ç™º

### ğŸƒâ€â™‚ï¸ é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆãƒãƒ¼ãƒˆ3001ï¼‰
make dev-frontend

# Firebase Functions ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿
make dev-functions

# å…¨ä½“ã®ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰
firebase emulators:start
```

### ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆ
make test

# å€‹åˆ¥å®Ÿè¡Œ
make test-frontend
make test-functions
```

### ğŸ—„ï¸ Firebaseç®¡ç†

```bash
# Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³ç¢ºèª
firebase projects:list

# Firestore ãƒ‡ãƒ¼ã‚¿ç¢ºèª
firebase firestore:indexes

# Firebase Functionsç¢ºèª
firebase functions:list

# ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ç¢ºèª
firebase deploy --dry-run
```

## ç’°å¢ƒå¤‰æ•°ç®¡ç†

### ğŸ”§ Firebase Functionsç’°å¢ƒå¤‰æ•°

```bash
# æœ¬ç•ªç’°å¢ƒã«è¨­å®šï¼ˆé€šå¸¸ã¯ CI/CD ã§è‡ªå‹•è¨­å®šï¼‰
firebase functions:config:set gemini.api_key="YOUR_PRODUCTION_API_KEY" --project insieme-463312

# é–‹ç™ºç’°å¢ƒã«è¨­å®šï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰æ‰‹å‹•è¨­å®šï¼‰
firebase use dev  # insieme-dev-d7459 ã«åˆ‡ã‚Šæ›¿ãˆ
firebase functions:config:set gemini.api_key="YOUR_DEV_API_KEY"

# è¨­å®šç¢ºèª
firebase functions:config:get --project insieme-463312  # æœ¬ç•ª
firebase functions:config:get --project insieme-dev-d7459  # é–‹ç™º

# Functionså†…ã§ã®ä½¿ç”¨æ–¹æ³•
# import * as functions from 'firebase-functions';
# const apiKey = functions.config().gemini.api_key;
```

### ğŸŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒå¤‰æ•°

ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ã® `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«:

```env
NEXT_PUBLIC_FIREBASE_API_KEY=your_firebase_api_key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
NEXT_PUBLIC_FIREBASE_APP_ID=your_app_id
```

## ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### ğŸ“„ Worksheetï¼ˆãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆï¼‰

```typescript
interface Worksheet {
  id: string;                    // ä¸€æ„è­˜åˆ¥å­
  title: string;                 // ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã‚¿ã‚¤ãƒˆãƒ«
  description?: string;          // èª¬æ˜æ–‡
  subject: string;               // ç§‘ç›®
  topic: string;                 // ãƒˆãƒ”ãƒƒã‚¯
  difficulty: string;            // é›£æ˜“åº¦ (easy/medium/hard)
  createdAt: string;             // ä½œæˆæ—¥æ™‚ (ISO string)
  createdBy: string;             // ä½œæˆè€…UID
  problems: Problem[];           // å«ã¾ã‚Œã‚‹å•é¡Œãƒªã‚¹ãƒˆ
  status?: WorksheetStatus;      // ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆçŠ¶æ…‹
}

type WorksheetStatus = 'creating' | 'error' | 'ready' | 'submitted';
```

### â“ Problemï¼ˆå•é¡Œï¼‰

```typescript
interface Problem {
  id: string;                    // å•é¡ŒID
  question: string;              // å•é¡Œæ–‡
  options?: string[] | null;     // é¸æŠè‚¢ï¼ˆé¸æŠå•é¡Œã®å ´åˆï¼‰
  correctAnswer: string;         // æ­£è§£
  explanation: string;           // è§£èª¬
  type?: string;                 // å•é¡Œå½¢å¼
}
```

### ğŸ“ WorksheetSubmissionï¼ˆæå‡ºï¼‰

```typescript
interface WorksheetSubmission {
  id: string;                    // æå‡ºID
  worksheetId: string;           // ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆID
  userId: string;                // æå‡ºè€…UID
  answers: ProblemAnswer[];      // å›ç­”ãƒªã‚¹ãƒˆ
  submittedAt: string;           // æå‡ºæ—¥æ™‚
  score?: number;                // å¾—ç‚¹
  totalProblems: number;         // ç·å•é¡Œæ•°
}

interface ProblemAnswer {
  problemId: string;             // å•é¡ŒID
  answer: string;                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›ç­”
  isCorrect?: boolean;           // æ­£èª¤åˆ¤å®š
}
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»åˆ¶é™

### ğŸ” Firestore ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«

- **ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ**: ä½œæˆè€…ã®ã¿èª­ã¿å–ã‚Šå¯èƒ½
- **æå‡ºãƒ‡ãƒ¼ã‚¿**: æå‡ºè€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- **Functions**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆä½œæˆå¯èƒ½
- **èªè¨¼**: Firebase Authenticationå¿…é ˆ

### ğŸ“Š åˆ©ç”¨åˆ¶é™

- **LLMç”Ÿæˆåˆ¶é™**: å®Ÿè£…äºˆå®šï¼ˆ1æ—¥ã‚ãŸã‚Šåˆ¶é™ï¼‰
- **ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆç·¨é›†**: ä½œæˆå¾Œã¯ç·¨é›†ä¸å¯
- **æ¨¡ç¯„è§£ç­”**: æå‡ºå¾Œã®ã¿é–²è¦§å¯èƒ½
- **ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼**: å…¨ã¦ä½œæˆè€…ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ğŸ”¥ Firebaseé–¢é€£ã‚¨ãƒ©ãƒ¼

#### èªè¨¼ã‚¨ãƒ©ãƒ¼

```bash
# Firebaseå†ãƒ­ã‚°ã‚¤ãƒ³
firebase login --reauth

# ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèª
firebase login:list

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¨©é™ç¢ºèª
firebase projects:list
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¨ãƒ©ãƒ¼

```bash
# æ¨©é™ç¢ºèª
firebase projects:list

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ‡ã‚Šæ›¿ãˆ
firebase use insieme-463312  # ã¾ãŸã¯ insieme-dev-d7459

# ãƒ‡ãƒ—ãƒ­ã‚¤å‰ãƒ†ã‚¹ãƒˆ
firebase deploy --dry-run

# å€‹åˆ¥ãƒ‡ãƒ—ãƒ­ã‚¤ã§ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ç‰¹å®š
firebase deploy --only hosting
firebase deploy --only functions
```

### ğŸ—ï¸ ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

```bash
# ä¾å­˜é–¢ä¿‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd frontend && rm -rf node_modules package-lock.json && npm install
cd ../functions && rm -rf node_modules package-lock.json && npm install

# TypeScriptå‹ãƒã‚§ãƒƒã‚¯
npm run type-check

# ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ
npm run build
```

### ğŸ”§ é–‹ç™ºç’°å¢ƒã‚¨ãƒ©ãƒ¼

```bash
# Next.js ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
cd frontend && rm -rf .next

# Firebase ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ
firebase emulators:start --import=./backup --export-on-exit=./backup

# ç’°å¢ƒå¤‰æ•°ç¢ºèª
cat .env.local
```

### ğŸ“± Functionsé–¢é€£ã‚¨ãƒ©ãƒ¼

```bash
# Functions ãƒ­ã‚°ç¢ºèª
firebase functions:log --project insieme-463312

# ç‰¹å®šé–¢æ•°ã®ãƒ­ã‚°
firebase functions:log --only generateProblems

# ãƒ­ãƒ¼ã‚«ãƒ« Functions ãƒ†ã‚¹ãƒˆ
cd functions && npm run serve
```

### ğŸŒ GitHub Actions ã‚¨ãƒ©ãƒ¼

1. **Secretsç¢ºèª**: GitHub ãƒªãƒã‚¸ãƒˆãƒªã® Secrets è¨­å®šã‚’ç¢ºèª
2. **æ¨©é™ç¢ºèª**: Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® IAM æ¨©é™ç¢ºèª
3. **ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°**: `firebase login:ci` ã§æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
4. **ãƒ­ã‚°ç¢ºèª**: GitHub Actions ã®è©³ç´°ãƒ­ã‚°ã‚’ç¢ºèª
